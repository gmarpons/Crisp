# -*- Python -*-

import os

config.name = 'crisp'
config.suffixes = ['.c', '.cpp']
config.test_format = lit.formats.ShTest()
config.unsupported = False
config.on_clone = None
config.test_exec_root = os.path.dirname(__file__)
config.test_source_root = os.path.dirname(__file__)
config.excludes = []
config.target_triple = '-vg'

config.available_features = []
config.available_features.append('asserts')
config.available_features.append('crash-recovery')

# CRISPTEST environment var needs to be set to run crisp clang plugin from build
# directories.
config.environment['CRISPTEST'] = '1'
clang_plugin_path = '%s/lib/CrispClangPlugin/libcrispclang.so' % config.crisp_obj_root
clang_plugin_otps = '-load %s -plugin crisp-clang' % clang_plugin_path
clang_opts = '-cc1 -fsyntax-only %s' % clang_plugin_otps
config.substitutions = []
config.substitutions.append(('%crisp_clang_cc1',
                             '%s %s' % (config.cmake_cxx_compiler, clang_opts)))
